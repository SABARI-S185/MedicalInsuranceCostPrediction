<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analysis Dashboard - Insurance Cost Prediction</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>üìä Exploratory Data Analysis Dashboard</h1>
            <p class="subtitle">Data insights and model performance metrics</p>
        </header>

        <nav>
            <a href="/">Prediction</a>
            <a href="/analysis">Analysis Dashboard</a>
        </nav>

        <main>
            <!-- Model Performance Metrics -->
            {% if metadata %}
            <div class="result-card">
                <h2>üéØ Model Performance Metrics</h2>
                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-label">Model Type</div>
                        <div class="metric-value">{{ metadata.model_type }}</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-label">R¬≤ Score</div>
                        <div class="metric-value">{{ "%.4f"|format(metadata.r2_score) }}</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-label">RMSE</div>
                        <div class="metric-value">${{ metadata.rmse|currency }}</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-label">MAE</div>
                        <div class="metric-value">${{ metadata.mae|currency }}</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-label">MAPE</div>
                        <div class="metric-value">{{ "%.2f"|format(metadata.mape) }}%</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-label">Training Date</div>
                        <div class="metric-value">{{ metadata.training_date }}</div>
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- EDA Visualizations -->
            <div class="result-card">
                <h2>üìà Data Visualizations</h2>
                <div class="plots-grid">
                    {% for plot in plots %}
                    <div class="plot-item">
                        <h3>{{ plot.replace('_', ' ').replace('.png', '').title() }}</h3>
                        <img src="{{ url_for('static', filename='plots/' + plot) }}" 
                             alt="{{ plot }}" 
                             class="eda-plot"
                             loading="lazy">
                    </div>
                    {% endfor %}
                </div>
            </div>

            <!-- Insights Section -->
            <div class="result-card">
                <h2>üîç Key Insights</h2>
                <div class="insights-content">
                    <h3>Data Overview</h3>
                    <ul>
                        <li><strong>Smoking Status:</strong> The strongest predictor of insurance costs. Smokers typically pay $20,000+ more annually.</li>
                        <li><strong>Age:</strong> Shows positive correlation with charges. Older individuals generally have higher premiums.</li>
                        <li><strong>BMI:</strong> Moderate impact on costs. Higher BMI (especially obese category) increases premiums.</li>
                        <li><strong>Children:</strong> Each child adds approximately $500-$1,000 to annual premium.</li>
                        <li><strong>Region:</strong> Minimal impact on insurance costs compared to other factors.</li>
                        <li><strong>Sex:</strong> Relatively minor impact on premium predictions.</li>
                    </ul>

                    <h3>Model Performance</h3>
                    <p>The selected model achieves strong predictive performance with an R¬≤ score above 0.75, indicating it captures the majority of variance in insurance costs. The model effectively learns non-linear relationships between features and the target variable.</p>
                </div>
            </div>

            <div class="action-buttons">
                <a href="/" class="btn-primary">Make a Prediction</a>
            </div>
        </main>

        <footer>
            <p>&copy; 2024 Insurance Cost Prediction System | Machine Learning Project</p>
        </footer>
    </div>
</body>
</html>

